

Here is a detailed describtion of how to setup the environment 
for offline automated data query and retrieval.


First of all you take a sample dataset through which you can connect with 
mongodb database, so that you can be able to fetch the data what you want.

So to connect through mongodb you need a mongoclient through which you can connect with mongodb.

client = MongoClient('mongodb://localhost:27017/')
You can connect through local host of your loacl system.

So you can either create a database or use a existing database like this:
["db = client['AIQoD'] # database name" ].

Once you craete a database then you need to create a collection within that database:
["collection = db['Sample_data'] # collection name" ].

You can either load the data through single entity like:
["collection.insert_one(d)"] or insert many entity like:
["collection.insert_many(l1)  # to insert  many collections at a time"].


So after successfully creating the database and collection in mongodb test some sample
query, so you can indentify it is working or not?


So after running some query if you can be able to fetch the desired data so you have successfully
created the system offline.

So after that you can save the output in a csv format to your desired location.

So next step is that you to select a llm LangChain model for mongodb query generation.

For eg: I have taken more then 5 model for mongodb query generation byut none of the will 
be able to giove that much accurate queries.

The models are : pipeline('text-generation', model='openai-community/gpt2')

Once i have trained the model with my dataset they were not giving the accurate query.

The second model is :  GPT2Tokenizer.from_pretrained('gpt2').
So this model is also not giving proper mongodb query and sometimes
it is giving the same prompt as query.

Eg: Setting `pad_token_id` to `eos_token_id`:50256 for open-end generation.
Prompt: Find all products with a rating below 4.5 that have more than 200 reviews are offered by the brand 'Nike' or 'Sony'
Expected Query: {"Rating": {"$gt": 4}}
Generated Query: Find all products with a rating below 4.5 that have more than 200 reviews are offered by the brand 'Nike' or 'Sony'


The other model is : pipeline('text2text-generation', model='facebook/bart-large').
This model is also not giving proper query for mongodb.

It is generating queries like this :
["prompt : Find all products with a rating_below 4.5 that have reviews_more_than 200 reviews 
and are offered by the brand 'Nike' or 'Sony'"]

Generated Query:["{'$and': [{'rating': {'$lt': 4.5}}, {'reviewCount': {'$gt': 200}}, {'brand': {'$in': ['Nike', 'Sony']}}]}
"], which is also doesn't look similar.


So last I found a model which is giving proper query that is :
model = ["ChatOpenAI(model'gpt-3.5-turbo') "]

So after using this model my userinterface is completed.

So in this user interface I have two things:
user need to enter a prompt based on that a mongodb query will be generated.

You can be able to store the query generated by the model and after that the data will
be fetched out of the query so yoi can be able to store the data in csv format.



                               The deliveries: 


I have different file in my folder:

main.py - it contains the main code for the user interface.

prompt.txt - it contains the detailed desribtion of each columns.

q&t.txt - it contaains some question.

sample_ques.txt - it contains some prompts and their relevant queries.

test_case.ipynb- it contains following Test Cases and the output for 3 test

cases in csv format along with code files and a Query generated by offline model
for respective data.

output folder - it contain outputs of the 3 above test case in csv format.

AIQod.ipynb - it contans code for loading the sample file to mongodb.
